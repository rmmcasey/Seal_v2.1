<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seal - Encrypt File</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Auth Check Screen -->
    <div id="screen-loading" class="screen active">
      <div class="loading-spinner"></div>
      <p class="loading-text">Checking authentication...</p>
    </div>

    <!-- Not Authenticated Screen -->
    <div id="screen-auth" class="screen">
      <div class="auth-container">
        <div class="logo-section">
          <div class="logo-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <path d="M12 2C9.24 2 7 4.24 7 7V10H6C4.9 10 4 10.9 4 12V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V12C20 10.9 19.1 10 18 10H17V7C17 4.24 14.76 2 12 2ZM12 4C13.66 4 15 5.34 15 7V10H9V7C9 5.34 10.34 4 12 4ZM12 14C13.1 14 14 14.9 14 16C14 17.1 13.1 18 12 18C10.9 18 10 17.1 10 16C10 14.9 10.9 14 12 14Z" fill="#3B82F6"/>
            </svg>
          </div>
          <h1>Seal</h1>
          <p>Sign in to encrypt and share files securely.</p>
        </div>
        <button id="btn-login" class="btn btn-primary btn-full">
          Sign in to Seal
        </button>
      </div>
    </div>

    <!-- Main Encryption Screen -->
    <div id="screen-encrypt" class="screen">
      <header class="header">
        <div class="header-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C9.24 2 7 4.24 7 7V10H6C4.9 10 4 10.9 4 12V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V12C20 10.9 19.1 10 18 10H17V7C17 4.24 14.76 2 12 2ZM12 4C13.66 4 15 5.34 15 7V10H9V7C9 5.34 10.34 4 12 4ZM12 14C13.1 14 14 14.9 14 16C14 17.1 13.1 18 12 18C10.9 18 10 17.1 10 16C10 14.9 10.9 14 12 14Z" fill="#3B82F6"/>
          </svg>
          <span>Seal File</span>
        </div>
        <div id="user-email" class="header-email"></div>
      </header>

      <!-- File Upload Section -->
      <section class="section">
        <label class="section-label">File</label>
        <div id="drop-zone" class="drop-zone">
          <input type="file" id="file-input" hidden>
          <div id="drop-zone-empty" class="drop-zone-content">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" class="drop-icon">
              <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20ZM12 12L16 16H13V19H11V16H8L12 12Z" fill="#9CA3AF"/>
            </svg>
            <p>Drop file here or <span class="link">browse</span></p>
            <p class="drop-hint">Max 5MB</p>
          </div>
          <div id="drop-zone-file" class="drop-zone-content" hidden>
            <div class="file-info">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z" fill="#3B82F6"/>
              </svg>
              <div class="file-details">
                <span id="file-name" class="file-name"></span>
                <span id="file-size" class="file-size"></span>
              </div>
              <button id="file-remove" class="file-remove" title="Remove file">&times;</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Recipients Section -->
      <section class="section">
        <label class="section-label">Recipients</label>
        <div class="recipients-input-wrapper">
          <input
            type="text"
            id="recipients-input"
            class="input"
            placeholder="Enter email addresses, comma separated"
          >
        </div>
        <div id="recipients-list" class="recipients-list"></div>
        <div id="recipients-error" class="field-error" hidden></div>
      </section>

      <!-- Expiration Section -->
      <section class="section">
        <label class="section-label">Expires after</label>
        <div class="expiration-options">
          <button class="exp-option" data-days="1">1 day</button>
          <button class="exp-option active" data-days="3">3 days</button>
          <button class="exp-option" data-days="7">7 days</button>
          <button class="exp-option" data-days="30">30 days</button>
        </div>
      </section>

      <!-- Encrypt Button -->
      <div class="action-section">
        <button id="btn-encrypt" class="btn btn-primary btn-full" disabled>
          <span class="btn-label">Encrypt &amp; Attach</span>
        </button>
      </div>
    </div>

    <!-- Progress Screen -->
    <div id="screen-progress" class="screen">
      <div class="progress-container">
        <div class="progress-icon">
          <div class="loading-spinner"></div>
        </div>
        <p id="progress-status" class="progress-status">Encrypting file...</p>
        <div class="progress-bar-track">
          <div id="progress-bar" class="progress-bar-fill"></div>
        </div>
        <div id="progress-steps" class="progress-steps">
          <div class="progress-step active" data-step="encrypt">
            <span class="step-dot"></span>
            <span>Encrypting</span>
          </div>
          <div class="progress-step" data-step="metadata">
            <span class="step-dot"></span>
            <span>Saving metadata</span>
          </div>
          <div class="progress-step" data-step="attach">
            <span class="step-dot"></span>
            <span>Attaching to Gmail</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Screen -->
    <div id="screen-success" class="screen">
      <div class="success-container">
        <div class="success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z" fill="#10B981"/>
          </svg>
        </div>
        <h2>File Sealed!</h2>
        <p id="success-filename" class="success-detail"></p>
        <p id="success-recipients" class="success-detail-sub"></p>
        <p id="success-expiry" class="success-detail-sub"></p>
        <button id="btn-done" class="btn btn-primary btn-full">Done</button>
        <button id="btn-seal-another" class="btn btn-secondary btn-full">Seal another file</button>
      </div>
    </div>

    <!-- Error Screen -->
    <div id="screen-error" class="screen">
      <div class="error-container">
        <div class="error-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="#EF4444"/>
          </svg>
        </div>
        <h2>Something went wrong</h2>
        <p id="error-message" class="error-detail"></p>
        <button id="btn-retry" class="btn btn-primary btn-full">Try Again</button>
      </div>
    </div>
  </div>

  <script src="../lib/seal-crypto.js"></script>
  <script src="popup.js"></script>
</body>
</html>
